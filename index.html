<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>ä»€éº¼æ™‚å€™å¯ä»¥å›å®¶ ä¸‹ç­æ™‚é–“è¨ˆç®—æ©Ÿ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #2d1b4e 0%, #1a1a2e 100%);
      margin: 0; padding: 20px; min-height: 100vh;
    }
    .main-wrapper {
      display: flex; flex-wrap: wrap; justify-content: center;
      gap: 20px; position: relative; z-index: 10; align-items: stretch;
    }
    .panel-tall { display: flex; flex-direction: column; }
    #holiday-box { justify-content: center; }
    .panel {
      background: white; border-radius: 12px;
      box-shadow: 0 8px 32px rgba(255, 107, 0, 0.3);
      padding: 20px; width: 100%; max-width: 360px;
      border: 2px solid #ff6b00; position: relative;
      transition: box-shadow 0.3s;
    }
    .panel:hover {
      box-shadow: 0 8px 40px rgba(255, 107, 0, 0.6), 0 0 30px rgba(255, 149, 0, 0.4);
    }
    .holiday-title {
      font-size: 22px; font-weight: bold; text-align: center;
      color: #ff6b00; margin-bottom: 10px; margin-top: 0;
    }
    .holiday-date { font-size: 16px; text-align: center; margin-bottom: 12px; color: #444; }
    .holiday-countdown { text-align: center; font-size: 16px; color: #555; }
    .horoscope {
      margin-top: 15px; padding: 12px;
      background: linear-gradient(135deg, #1a1a2e 0%, #2d1b4e 100%);
      border-radius: 8px; color: #ffb347; font-size: 14px; line-height: 1.6;
      box-shadow: 0 2px 8px rgba(255, 107, 0, 0.3); border: 1px solid #ff6b00;
    }
    .flip-number {
      display: inline-block; font-family: 'Courier New', monospace;
      background: linear-gradient(135deg, #ff6b00 0%, #ff9500 100%);
      color: #fff; padding: 10px 14px; border-radius: 6px;
      font-size: 26px; margin: 0 6px;
      box-shadow: 0 4px 12px rgba(255, 107, 0, 0.4); border: none; letter-spacing: 1px;
    }
    h1, h2 { text-align: center; color: #ff6b00; }
    label { font-size: 16px; display: block; margin-top: 10px; }
    input[type="text"] {
      width: 100%; padding: 10px; margin: 5px 0 15px;
      border: 2px solid #ffb347; border-radius: 4px; font-size: 16px; transition: border 0.3s;
    }
    input[type="text"]:focus { outline: none; border-color: #ff6b00; }
    button {
      background: linear-gradient(135deg, #ff6b00 0%, #ff9500 100%);
      color: white; padding: 14px; font-size: 18px; border: none; border-radius: 4px;
      cursor: pointer; width: 100%; position: relative; overflow: hidden;
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 107, 0, 0.6);
      transition: all 0.3s;
    }
    button:hover::after {
      content: 'ğŸ„';
      position: absolute; right: 15px; top: 50%;
      transform: translateY(-50%); animation: ghostFloat 2s infinite;
    }
    @keyframes ghostFloat { 0%, 100% { transform: translateY(-50%); } 50% { transform: translateY(-70%); } }
    #result { text-align: center; margin-top: 20px; font-size: 18px; }
    #countdown {
      margin-top: 25px; padding: 20px;
      background: linear-gradient(135deg, #ff6b00 0%, #ff9500 100%);
      border-radius: 10px; text-align: center; display: none;
      color: white; box-shadow: 0 4px 12px rgba(255, 107, 0, 0.4); border: 2px solid #ff6b00;
    }
    #countdown-display { display: flex; justify-content: center; gap: 10px; margin-top: 15px; }
    .countdown-unit { background: rgba(255,255,255,0.2); border-radius: 8px; padding: 15px 20px; min-width: 80px; }
    .countdown-number { font-size: 32px; font-weight: bold; display: block; }
    .countdown-label { font-size: 14px; margin-top: 5px; opacity: 0.9; }
    .countdown-reminder { margin-top: 10px; font-size: 13px; opacity: 0.9; }
    #loading { display: none; text-align: center; margin: 20px 0; }
    .ghost-loader { display: inline-block; font-size: 50px; animation: ghostSpin 1.5s linear infinite; }
    @keyframes ghostSpin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    #xmasOverlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.9);
      display: none; justify-content: center; align-items: center; flex-direction: column;
      z-index: 9999; padding: 20px;
    }
    #xmasOverlay button {
      background: linear-gradient(135deg, #ff6b00 0%, #ff9500 100%);
      border: none; color: #fff; padding: 10px 16px; border-radius: 6px;
      margin: 6px; cursor: pointer;
    }

    .snowflake {
      position: fixed; color: white; pointer-events: none; z-index: 0;
      text-shadow: 0 0 8px rgba(255,255,255,0.6);
    }

    .mariah-wrap {
      position: relative; border-radius: 8px; overflow: hidden;
    }
    .mariah-video { width: 100%; border-radius: 8px; display: block; }

    .friday-close {
      background: white; color: #f5576c; border: none;
      padding: 12px 30px; font-size: 16px; border-radius: 25px;
      cursor: pointer; font-weight: bold; margin-top: 20px;
    }
    .friday-close:hover { transform: scale(1.05); }

    @media (max-width: 1024px) {
      .main-wrapper { flex-direction: column; align-items: center; }
    }
  </style>
</head>
<body>
  <div id="xmasOverlay"></div>

  <div class="main-wrapper">
    <div class="panel panel-tall" id="holiday-box"></div>

    <div class="panel panel-tall">
      <h1>ä»€éº¼æ™‚å€™å¯ä»¥å›å®¶</h1>
      <h2>HURCä¸‹ç­æ™‚é–“è¨ˆç®—æ©Ÿ</h2>
      <label for="start">ä¸Šç­æ™‚é–“ (hhmm):</label>
      <input type="text" id="start" placeholder="HHMM" inputmode="numeric" pattern="[0-9]*" />
      <button onclick="calc()">è¨ˆç®—ä½ çš„ä¸‹ç­æ™‚é–“</button>
      <div id="loading">
        <div class="ghost-loader">ğŸ…</div>
        <div style="margin-top:10px;color:#666;">è¨ˆç®—ä¸­...</div>
      </div>
      <h3 id="result"></h3>
      <div id="countdown">
        <div style="font-size:18px;font-weight:bold;margin-bottom:15px">è·é›¢å¯ä»¥é›¢é–‹è¾¦å…¬å®¤é‚„æœ‰</div>
        <div id="countdown-display">
          <div class="countdown-unit">
            <span class="countdown-number" id="h">00</span>
            <div class="countdown-label">å°æ™‚</div>
          </div>
          <div class="countdown-unit">
            <span class="countdown-number" id="m">00</span>
            <div class="countdown-label">åˆ†é˜</div>
          </div>
          <div class="countdown-unit">
            <span class="countdown-number" id="s">00</span>
            <div class="countdown-label">ç§’</div>
          </div>
        </div>
        <div class="countdown-reminder">ğŸ’¡ ä¸è¦åŠ ç­å¤ªä¹…å–”ï¼</div>
      </div>
    </div>

    <div class="panel panel-tall">
      <div class="holiday-title" style="margin-bottom:12px;">â„ï¸ æ­£åœ¨è§£å‡ Mariah Carey...</div>
      <div class="mariah-wrap" id="mariahWrap">
        <video id="mariahVideo" class="mariah-video" src="./mariah-defrosting-slow.mp4" muted playsinline preload="auto"></video>
      </div>
    </div>
  </div>

  <div style="text-align: center; margin-top: 20px; padding: 15px;">
    <div style="font-size: 14px; color: #ffe2bf;">ğŸ‘©â€ğŸ’» æ²›æ© æ›´æ–°æ–¼ 2025 å¹´ 11 æœˆ 2 æ—¥</div>
    <div style="font-size: 13px; color: #ffe2bf; margin-top: 5px;">ğŸ“ å›ä¾†ä¸Šç­äº†ï¼±ï¼±</div>
  </div>

  <script>
    let timer, offTime;

    function update() {
      if (!offTime) return;
      const now = new Date();
      const diff = offTime - now;
      if (diff <= 0) {
        clearInterval(timer);
        document.getElementById('countdown').style.display = 'none';
        const result = document.getElementById('result');
        if (!result.innerHTML.includes('ä¸‹ç­æ™‚é–“åˆ°äº†')) {
          result.innerHTML += '<br><br>ğŸ‰ <strong>ä¸‹ç­æ™‚é–“åˆ°äº†ï¼å¿«å›å®¶å§ï¼</strong>';
        }
        return;
      }
      document.getElementById('h').textContent = String(Math.floor(diff / 3600000)).padStart(2, '0');
      document.getElementById('m').textContent = String(Math.floor(diff % 3600000 / 60000)).padStart(2, '0');
      document.getElementById('s').textContent = String(Math.floor(diff % 60000 / 1000)).padStart(2, '0');
    }

    function calc() {
      const input = document.getElementById("start").value;
      const result = document.getElementById("result");
      const loading = document.getElementById("loading");
      loading.style.display = 'block';
      result.innerHTML = '';
      document.getElementById('countdown').style.display = 'none';

      setTimeout(() => {
        loading.style.display = 'none';

        if (!input || input.length !== 4 || isNaN(input)) { result.innerText = "è«‹æ‚¨å†ä»”ç´°ç¢ºèªä¸Šç­æ™‚é–“ï¼Œä¸è¦ç©ç³»çµ± ^^"; return; }
        const h = parseInt(input.substring(0, 2)), min = parseInt(input.substring(2, 4));
        if (h < 0 || h > 23 || min < 0 || min > 59) { result.innerText = "è«‹æ‚¨å†ä»”ç´°ç¢ºèªä¸Šç­æ™‚é–“ï¼Œä¸è¦ç©ç³»çµ± ^^"; return; }
        if (input >= "0000" && input < "0730") { result.innerText = "ä¸Šç­æ™‚é–“æœ€æ—©å¾ 07:30 æ‰“å¡å”·ï¼"; return; }
        if (input >= "1200" && input <= "2359") { result.innerText = "å»ºè­°æ‚¨ç›´æ¥è«‹å‡ ^^"; return; }
        const now = new Date();
        const start = new Date(now.getFullYear(), now.getMonth(), now.getDate(), h, min, 0);
        const work = 9.5 * 3600000;
        const late = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 9, 0, 0);

        if (start > late) {
          const leaveMins = Math.ceil((start - late) / 60000 / 30) * 30;
          const leaveStart = new Date(start.getTime() - leaveMins * 60000);
          const properOffTime = new Date(leaveStart.getTime() + work);
          result.innerHTML =
            (h >= 11 ? "âš ï¸ å¤ªæ™šäº†å§ï¼è¦ä¸è¦ç›´æ¥å›å®¶<br>" : "âš ï¸ æ³¨æ„ï¼æ‚¨å·²ç¶“é²åˆ°äº†ï¼<br>") +
            `å»ºè­°æ‚¨é€™æ¨£è«‹å‡ï¼š${leaveStart.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })} - ${start.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}ã€‚<br>` +
            `â° å»ºè­°è«‹å‡æ™‚é•·ç‚ºï¼š${Math.floor(leaveMins/60)}å°æ™‚${leaveMins%60}åˆ†é˜ã€‚<br>`;
          result.innerHTML += `ğŸ•” è«‹å®Œå‡å¾Œå»ºè­°åœ¨ ${properOffTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })} ä¸‹ç­`;
          offTime = new Date(start.getTime() + work);
        } else {
          result.innerHTML = "ğŸ‰ ä»Šå¤©åŠªåŠ›èµ·åºŠä¸Šç­äº†ï¼ç¹¼çºŒä¿æŒï¼<br>";
          offTime = new Date(start.getTime() + work);
          result.innerHTML += `ğŸ•” æ‚¨çš„ä¸‹ç­æ™‚é–“æ˜¯ï¼š${offTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}`;
        }

        document.getElementById('countdown').style.display = 'block';
        if (timer) clearInterval(timer);
        update();
        timer = setInterval(update, 1000);
      }, 800);
    }

    // è–èª•å€’æ•¸ + æ˜Ÿåº§å»ºè­°
    (function(){
      const today = new Date();
      const christmas = new Date(today.getFullYear(), 11, 25);
      if (christmas < today) christmas.setFullYear(today.getFullYear() + 1);
      const daysLeft = Math.ceil((christmas - today) / 86400000);
      const giftHoroscopes = [
      { sign: "â™ˆ ç‰¡ç¾Šåº§", msg: "è¡Œå‹•æ´¾çš„ä½ æœ€é©åˆæ”¶åˆ°ä¸€å°å’–å•¡æ©Ÿï¼Œæç¥åˆæé€Ÿ â˜•" },
      { sign: "â™‰ é‡‘ç‰›åº§", msg: "ä¸€æ¢é«˜ç´šåœå·¾æœ€èƒ½æº«æš–ä½ â€”â€”é‚„æœ‰ä½ çš„ç†è²¡å¿ƒ ğŸ’°" },
      { sign: "â™Š é›™å­åº§", msg: "å…©ä»½ç¦®ç‰©æœƒè®“ä½ æ¯”è¼ƒä¸ç³¾çµï¼Œå› ç‚ºä½ éƒ½æƒ³è¦ ğŸ˜" },
      { sign: "â™‹ å·¨èŸ¹åº§", msg: "æŸ”è»Ÿæ¯›æ¯¯ + ç†±å¯å¯ï¼Œå®Œç¾çš„å†¬å¤œæ¨™é… ğŸ’–" },
      { sign: "â™Œ ç…å­åº§", msg: "é‡‘è‰²é¦™æ°´æˆ–äº®ç‰‡å¤–å¥—ï¼Œè®“ä½ åœ¨æ´¾å°ä¸Šé–ƒçå…¨å ´ âœ¨" },
      { sign: "â™ è™•å¥³åº§", msg: "æ•´é½Šçš„æ‰‹å¸³æœ¬æœƒè®“ä½ å¿ƒæƒ…å¤§å¥½ ğŸ“˜" },
      { sign: "â™ å¤©ç§¤åº§", msg: "é¦™æ°›è Ÿç‡­èƒ½è®“ä½ æ‰¾åˆ°ç¯€æ—¥çš„å¹³è¡¡èˆ‡æµªæ¼« ğŸ”¥" },
      { sign: "â™ å¤©è åº§", msg: "ç¥ç§˜é»‘å·§å…‹åŠ›ç¦®ç›’ï¼Œä¸€å£ç”œä¸€å£å¿ƒå‹• ğŸ«" },
      { sign: "â™ å°„æ‰‹åº§", msg: "è–èª•å°±è©²ç™¼æ—…è¡Œçé‡‘æˆ–æ˜¯ç›´æ¥æ”¾ä½ ä¸‹ç­ âœˆï¸" },
      { sign: "â™‘ æ‘©ç¾¯åº§", msg: "å¯¦ç”¨çš„ä¿æº«ç“¶æˆ–ç­†é›»æ”¯æ¶ï¼Œè·å ´è–èª• MVP ğŸ’¼" },
      { sign: "â™’ æ°´ç“¶åº§", msg: "é›»å­å°ç©å…·æ˜¯ä½ çš„æµªæ¼«ï¼Œè¶Šæ€ªè¶Šå–œæ­¡ âš¡" },
      { sign: "â™“ é›™é­šåº§", msg: "éŸ³æ¨‚ç›’æˆ–æ˜Ÿç©ºç‡ˆï¼Œè®“å¤¢æƒ³åœ¨å¤œè£¡é–ƒé–ƒç™¼å…‰ ğŸŒ™" }
      ];
      const randomGift = giftHoroscopes[Math.floor(Math.random() * giftHoroscopes.length)];
      document.getElementById("holiday-box").innerHTML =
        `<div class="holiday-title">ğŸ„ è–èª•ç¯€å€’æ•¸</div>
         <div class="holiday-date">è·é›¢è–èª•ç¯€é‚„æœ‰ <span class="flip-number">${daysLeft}</span> å¤©</div>
         <div class="horoscope"><strong>${randomGift.sign}</strong><br>${randomGift.msg}</div>`;
    })();

    // Mariah Carey æ’­æ”¾é»ä½ä¾æ—¥æœŸ
    const mariahVideo = document.getElementById("mariahVideo");
    mariahVideo.addEventListener("loadedmetadata", () => {
      const today = new Date();
      const yearStart = new Date(today.getFullYear(), 0, 1);
      const dayOfYear = Math.floor((today - yearStart) / 86400000);
      const christmasEveDay = Math.floor((new Date(today.getFullYear(), 11, 24) - yearStart) / 86400000);
      const progress = Math.min(dayOfYear / christmasEveDay, 1);
      mariahVideo.currentTime = mariahVideo.duration * progress;
    });

    // å¹æ°£äº’å‹•
    const mariahWrap = document.getElementById("mariahWrap");
    const fog = document.createElement("div");
    fog.style.position = "absolute";
    fog.style.inset = "0";
    fog.style.pointerEvents = "none";
    fog.style.backdropFilter = "blur(0px)";
    fog.style.transition = "backdrop-filter 0.15s ease";
    fog.style.borderRadius = "8px";
    mariahWrap.appendChild(fog);

    let blowing = false;
    let blurLevel = 0;
    let blowCount = 0;

    function startBlow() {
      blowing = true;
      blurLevel = Math.min(12, blurLevel + 2);
      fog.style.backdropFilter = `blur(${blurLevel}px)`;
    }
    function stopBlow() {
      if (!blowing) return;
      blowing = false;
      blowCount++;
      setTimeout(() => {
        blurLevel = Math.max(0, blurLevel - 1.5);
        fog.style.backdropFilter = `blur(${blurLevel}px)`;
      }, 200);

      if (blowCount >= 3) {
        const overlay = document.getElementById("xmasOverlay");
        overlay.style.display = "flex";
        overlay.innerHTML = `
          <div style="
            max-width:380px;
            padding:24px;
            border-radius:16px;
            background:rgba(255,255,255,0.15);
            backdrop-filter:blur(12px);
            border:1px solid rgba(255,215,128,0.6);
            box-shadow:0 0 25px rgba(255,200,100,0.3);
            text-align:center;
          ">
            <div style="font-size:20px;color:#ffe9b3;margin-bottom:14px;font-weight:600;">
              ğŸ’¬ Mariahï¼šä½ å·²ç¶“ç­‰ä¸åŠè¦å…ˆè½æˆ‘å”±äº†å—ï¼Ÿ
            </div>
            <div style="font-size:14px;color:#fff9e6;margin-bottom:18px;opacity:0.9;">
              æ»‘é¼ å†é»ä¸€æ¬¡æ‰æ’­éŸ³æ¨‚ã€‚ï¼ˆğŸ¶ æ’­æ”¾ / âŒ å–æ¶ˆï¼‰
            </div>
            <button id="playBtn" style="
              background:linear-gradient(135deg,#f8c25c 0%,#ff9500 100%);
              border:none;color:#fff;padding:10px 20px;border-radius:8px;
              font-size:16px;cursor:pointer;margin:4px 8px;
            ">ğŸ¶ æ’­æ”¾</button>
            <button id="cancelBtn" style="
              background:rgba(0,0,0,0.25);
              border:1px solid rgba(255,255,255,0.4);
              color:#fff;padding:10px 20px;border-radius:8px;
              font-size:16px;cursor:pointer;margin:4px 8px;
            ">âŒ å–æ¶ˆ</button>
          </div>
        `;
        document.getElementById("playBtn").onclick = () => {
          overlay.innerHTML = `
            <iframe src="https://www.youtube.com/embed/aAkMkVFwAoo?autoplay=1&controls=1&fs=1&rel=0"
                    allow="autoplay; fullscreen" allowfullscreen
                    style="width:100%;height:100%;border:none;"></iframe>
          `;
        };
        document.getElementById("cancelBtn").onclick = () => {
          overlay.style.display = "none";
        };
      }
    }

    mariahWrap.addEventListener("mousedown", startBlow);
    document.addEventListener("mouseup", stopBlow);
    mariahWrap.addEventListener("touchstart", (e) => { e.preventDefault(); startBlow(); }, { passive: false });
    document.addEventListener("touchend", stopBlow);
    document.addEventListener("keydown", (e) => {
      if (e.code === "Space") { e.preventDefault(); startBlow(); }
    });
    document.addEventListener("keyup", (e) => {
      if (e.code === "Space") { stopBlow(); }
    });

    // é›ªèŠ±
    const snowflakes = [];
    const maxSnow = 50;
    class Snow {
      constructor() {
        this.size = Math.random() * 10 + 6;
        this.x = Math.random() * window.innerWidth;
        this.y = -this.size;
        this.vx = (Math.random() - 0.5) * 0.3;
        this.vy = Math.random() * 0.5 + 0.2;
        this.el = document.createElement('div');
        this.el.className = 'snowflake';
        this.el.textContent = 'â„ï¸';
        this.el.style.fontSize = this.size + 'px';
        document.body.appendChild(this.el);
      }
      update() {
        this.x += this.vx; this.y += this.vy;
        if (this.y >= window.innerHeight - this.size) {
          this.y = window.innerHeight - this.size;
          this.vy = 0; this.vx = 0;
        }
        this.el.style.left = this.x + 'px';
        this.el.style.top = this.y + 'px';
      }
    }
    function createSnow() {
      if (snowflakes.length < maxSnow) snowflakes.push(new Snow());
    }
    function animateSnow() {
      createSnow();
      snowflakes.forEach(s => s.update());
      requestAnimationFrame(animateSnow);
    }
    animateSnow();
  </script>
</body>
</html>
